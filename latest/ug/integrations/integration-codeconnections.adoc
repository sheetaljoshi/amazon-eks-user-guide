include::../attributes.txt[]

[.topic]
[#integration-codeconnections]
= Connect to Git repositories with {aws} CodeConnections
:info_titleabbrev: {aws} CodeConnections

[abstract]
--
{aws} CodeConnections provides secure authentication to third-party Git repositories like GitHub, GitLab, and Bitbucket.
--

link:dtconsole/latest/userguide/welcome-connections.html[{aws} CodeConnections,type="documentation"] provides a secure way to connect {aws} services to third-party source code repositories.
{aws} CodeConnections supports GitHub, GitLab, Bitbucket, and link:dtconsole/latest/userguide/supported-versions-connections.html[other providers,type="documentation"].
To learn more and get started, see link:dtconsole/latest/userguide/connections.html[Working with connections,type="documentation"].

[#integration-codeconnections-use]
== Use {aws} CodeConnections with Argo CD

When using the EKS capability for Argo CD, you can choose to use {aws} CodeConnections to enable secure authentication to Git repositories without managing long-lived credentials or personal access tokens.
{aws} CodeConnections handles the OAuth authentication flow and manages the connection to your Git provider, providing a secure and manageable approach to accessing your GitOps repositories and application manifests stored in third-party Git providers.

*Prerequisites*

* An Amazon EKS cluster with the Argo CD capability created
* A connection created in {aws} CodeConnections to your Git provider
* IAM permissions configured for Argo CD to use the connection

*To configure CodeConnections for Argo CD repository access*

. Create a connection in the CodeConnections console:
.. Open the link:https://console.aws.amazon.com/codesuite/settings/connections[CodeConnections console^].
.. Choose *Create connection*.
.. Select your provider (GitHub, GitLab, or Bitbucket) and follow the authentication flow.
.. Note the connection ARN for use in your Argo CD configuration.

. Ensure the Argo CD capability role has permissions to use the connection with a resource-based policy:
+
[source,json,subs="verbatim,attributes"]
----
{
  "Version": "2012-10-17",{tcx5-waiver}
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "codeconnections:UseConnection",
        "codeconnections:GetConnection"
      ],
      "Resource": "arn:aws:codeconnections:region:account-id:connection/connection-id"
    }
  ]
}
----

. Configure Argo CD to reference the CodeConnections resource when adding a repository, using the CodeConnections resource endpoint as the repository url. The Argo CD capability uses the connection to authenticate to your Git provider without requiring long-lived credentials.

[#integration-codeconnections-considerations]
== Considerations for using CodeConnections with Argo CD

When using {aws} CodeConnections with the EKS Capability for Argo CD, keep the following in mind:

* The CodeConnections connection must be in the same {aws} Region as your EKS cluster
* The Argo CD capability role must have `codeconnections:UseConnection` and `codeconnections:GetConnection` permissions
* CodeConnections manages the OAuth flow and credential lifecycle automatically

For more information about configuring repository access with Argo CD, see <<argocd-configure-repositories>>.
